<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ListView?>
<?import javafx.scene.control.Tab?>
<?import javafx.scene.control.TabPane?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.chart.BarChart?>
<?import javafx.scene.chart.CategoryAxis?>
<?import javafx.scene.chart.LineChart?>
<?import javafx.scene.chart.NumberAxis?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.text.Font?>

<BorderPane prefHeight="800.0" prefWidth="1280.0" stylesheets="@admin_theme.css" xmlns="http://javafx.com/javafx/17" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.visiboard.pc.controller.AdminPanelController">
   
   <!-- Left Sidebar -->
   <left>
      <VBox prefWidth="250.0" spacing="10.0" styleClass="sidebar">
         <padding>
            <Insets bottom="20.0" left="15.0" right="15.0" top="30.0" />
         </padding>
         <children>
            <!-- Logo area -->
            <Label text="VisiBoard" styleClass="sidebar-title">
               <graphic>
                  <Label text="âš¡" textFill="#e1bee7" style="-fx-font-size: 24px;"/>
               </graphic>
            </Label>
            
            <Label text="Admin Panel" textFill="#ce93d8">
               <font><Font size="12.0"/></font>
               <VBox.margin><Insets top="-10" bottom="20"/></VBox.margin>
            </Label>

            <!-- Navigation -->
            <Label text="DASHBOARD" textFill="#b39ddb" style="-fx-font-size: 10px; -fx-font-weight: bold;"/>
            <Button fx:id="navAnalytics" text="ðŸ“ˆ Analytics" maxWidth="Infinity" styleClass="nav-button"/>
            <Button fx:id="navReports" text="ðŸš© Reports" maxWidth="Infinity" styleClass="nav-button"/>
            <Button fx:id="navUsers" text="ðŸ‘¥ Users" maxWidth="Infinity" styleClass="nav-button"/>
            <Button fx:id="navMap" text="ðŸ—º Map" maxWidth="Infinity" styleClass="nav-button"/>

            <Region VBox.vgrow="ALWAYS" />
            
            <!-- User/Logout -->
            <VBox spacing="10" style="-fx-background-color: rgba(0,0,0,0.2); -fx-background-radius: 10; -fx-padding: 15;">
                <Label fx:id="adminNameLabel" text="Administrator" textFill="white" style="-fx-font-weight: bold;"/>
                <Button fx:id="logoutButton" text="Logout" maxWidth="Infinity" style="-fx-background-color: #e53935; -fx-text-fill: white; -fx-background-radius: 5; -fx-cursor: hand;"/>
            </VBox>
         </children>
      </VBox>
   </left>

   <!-- Main Content Area -->
   <center>
      <StackPane fx:id="contentArea" styleClass="content-area">
          <children>
          
              <!-- 1. Analytics View -->
              <VBox fx:id="viewAnalytics" spacing="20.0" visible="true">
                 <children>
                    <HBox alignment="CENTER_LEFT" spacing="20">
                        <Label text="Analytics Overview" styleClass="header-label"/>
                        <Region HBox.hgrow="ALWAYS" />
                        <Button fx:id="refreshAnalyticsButton" text="ðŸ”„ Refresh Data" styleClass="action-button"/>
                    </HBox>
                    <Label text="Real-time application statistics" styleClass="sub-header-label"/>
                    
                    <!-- Stats Cards Row -->
                    <HBox spacing="20">
                        <VBox styleClass="dashboard-card" HBox.hgrow="ALWAYS">
                           <Label text="Total Users" styleClass="card-title"/>
                           <Label fx:id="usersCountLabel" text="0" styleClass="card-value"/>
                        </VBox>
                        <VBox styleClass="dashboard-card" HBox.hgrow="ALWAYS">
                           <Label text="Total Notes" styleClass="card-title"/>
                           <Label fx:id="notesCountLabel" text="0" styleClass="card-value"/>
                        </VBox>
                        <VBox styleClass="dashboard-card" HBox.hgrow="ALWAYS">
                           <Label text="Pending Reports" styleClass="card-title"/>
                           <Label fx:id="reportsCountLabel" text="0" styleClass="card-value" style="-fx-text-fill: #e53935;"/>
                        </VBox>
                    </HBox>
                    
                    <!-- Charts Row -->
                     <HBox spacing="20" VBox.vgrow="ALWAYS">
                          <VBox styleClass="dashboard-card" HBox.hgrow="ALWAYS">
                              <Label text="Weekly Activity" styleClass="card-title"/>
                              <BarChart fx:id="notesBarChart" legendVisible="false" verticalGridLinesVisible="false">
                                <xAxis><CategoryAxis side="BOTTOM" /></xAxis>
                                <yAxis><NumberAxis side="LEFT" /></yAxis>
                              </BarChart>
                          </VBox>
                          <VBox styleClass="dashboard-card" HBox.hgrow="ALWAYS">
                              <Label text="User Growth" styleClass="card-title"/>
                              <LineChart fx:id="usersLineChart" legendVisible="false" verticalGridLinesVisible="false">
                                <xAxis><CategoryAxis side="BOTTOM" /></xAxis>
                                <yAxis><NumberAxis side="LEFT" /></yAxis>
                              </LineChart>
                          </VBox>
                     </HBox>
                 </children>
              </VBox>

              <!-- 2. Reports View -->
              <VBox fx:id="viewReports" spacing="20.0" visible="false">
                 <children>
                    <HBox alignment="CENTER_LEFT" spacing="20">
                        <VBox>
                            <Label text="Moderation Queue" styleClass="header-label"/>
                            <Label text="Review and act on reports" styleClass="sub-header-label"/>
                        </VBox>
                        <Region HBox.hgrow="ALWAYS"/>
                        <Button fx:id="refreshReportsButton" text="Refresh List" styleClass="action-button"/>
                    </HBox>

                    <!-- Reports List Area -->
                    <TabPane fx:id="reportsSubTabPane" tabClosingPolicy="UNAVAILABLE" VBox.vgrow="ALWAYS" style="-fx-background-color: transparent;">
                        <tabs>
                            <Tab text="Reported Notes">
                                <content>
                                     <VBox style="-fx-padding: 10 0 0 0;">
                                        <ListView fx:id="reportsListViewNotes" styleClass="modern-list-view" VBox.vgrow="ALWAYS"/>
                                     </VBox>
                                </content>
                            </Tab>
                            <Tab text="Reported Users">
                                <content>
                                     <VBox style="-fx-padding: 10 0 0 0;">
                                        <ListView fx:id="reportsListViewUsers" styleClass="modern-list-view" VBox.vgrow="ALWAYS"/>
                                     </VBox>
                                </content>
                            </Tab>
                        </tabs>
                    </TabPane>
                 </children>
              </VBox>

              <!-- 3. Users View -->
              <VBox fx:id="viewUsers" spacing="20.0" visible="false">
                 <children>
                    <Label text="User Management" styleClass="header-label"/>
                    
                    <!-- Toolbar -->
                    <HBox spacing="15" alignment="CENTER_LEFT" styleClass="dashboard-card" style="-fx-padding: 10;">
                         <TextField fx:id="userSearchField" promptText="Search by name or email..." styleClass="modern-field" HBox.hgrow="ALWAYS"/>
                         <ComboBox fx:id="userFilterComboBox" promptText="Filter Status" style="-fx-background-color: #f3e5f5; -fx-background-radius: 20;"/>
                         <Button fx:id="refreshUsersButton" text="Refresh" styleClass="action-button"/>
                    </HBox>
                    
                    <ListView fx:id="userListView" styleClass="modern-list-view" VBox.vgrow="ALWAYS"/>
                 </children>
              </VBox>

              <!-- 4. Map View -->
              <VBox fx:id="viewMap" spacing="0" visible="false">
                  <children>
                      <!-- Map Content Loaded Dynamically -->
                      <StackPane VBox.vgrow="ALWAYS" style="-fx-background-color: #e0e0e0;">
                          <Label text="Loading Map Component..." style="-fx-text-fill: #757575;"/>
                      </StackPane>
                  </children>
              </VBox>

          </children>
      </StackPane>
   </center>
   
</BorderPane>
